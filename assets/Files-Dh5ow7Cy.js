import{a as o,q as g,j as e}from"./index-CZt83LK4.js";import"./DefaultLayout-DGZlj-q1.js";import{a as n,c as T}from"./index.esm-CLmi5pCK.js";import{j as _,k as I}from"./api-CWYGUJ6F.js";import{c as r}from"./toastUtils-D1hspjWq.js";import{C as P,a as w}from"./CRow-CSkPSwyb.js";import{C as S,a as k}from"./CCardBody-D9ngTYt-.js";import{C as M}from"./CCardHeader-3KwZfAgr.js";import{C as v,a as z,b as C,c as i,d as D,e as d}from"./CTable-COCXbL1g.js";import{c as E}from"./cil-trash-CBbKHhHb.js";import{C as N,a as U,b as A,c as B,d as H}from"./CModalTitle-DPjCy8m-.js";import{C as R}from"./CForm-DMxkCchm.js";import{a as L,C as q}from"./CFormInput-CvH69kim.js";import"./hz_logo_5-D5PyajDh.js";import"./cil-user-Ddrdy7PS.js";const re=()=>{const[f,x]=o.useState([]),{id:a}=g(),[m,t]=o.useState(!1),[p,j]=o.useState(null),[h,F]=o.useState("");o.useEffect(()=>{console.log("URL parameter ID:",a),F(a),c(a)},[a]);const u=async s=>{const l=await I(s);console.log(l),c(a),r("File deleted successfully",1)},y=async()=>{if(!p||!h){r("Please select a file and provide panel ID",2);return}const s=new FormData;s.append("file",p),s.append("panel_id",h);try{const l=await fetch("http://13.203.228.41:8000/upload-file/",{method:"POST",body:s});if(l.ok)r("File uploaded successfully",1),t(!1);else{const b=await l.json();console.log("Upload failed: "+b.detail),r("Upload failed",2)}}catch(l){console.error("Error uploading file:",l),alert("Upload error"),r("Internal server error",2)}c(a)},c=async s=>{try{const l=await _(s);x(l),console.log(l)}catch{setError("Failed to load panels"),r("Internal server error",2)}};return e.jsxs(e.Fragment,{children:[e.jsx(P,{children:e.jsx(w,{xs:12,children:e.jsxs(S,{className:"mb-4",children:[e.jsxs(M,{children:[e.jsx("strong",{children:"Files"}),e.jsx(n,{color:"primary",size:"sm",className:"float-end",onClick:()=>t(!m),children:"Add Files"})]}),e.jsx(k,{children:e.jsxs(v,{children:[e.jsx(z,{children:e.jsxs(C,{children:[e.jsx(i,{scope:"col",children:"File Id"}),e.jsx(i,{scope:"col",children:"Panel Name"}),e.jsx(i,{scope:"col",children:"File Name"}),e.jsx(i,{scope:"col",children:"Actions"})]})}),e.jsx(D,{children:f.map((s,l)=>e.jsxs(C,{children:[e.jsx(i,{children:s.file_meta_id}),e.jsx(d,{children:s.panel_id}),e.jsx(d,{children:s.file_name}),e.jsx(d,{children:e.jsx(n,{size:"sm",onClick:()=>u(s.file_meta_id),children:e.jsx(T,{icon:E,size:"sm"})})})]},s.file_meta_id+" "+s.panel_id))})]})})]})})}),e.jsxs(N,{alignment:"center",visible:m,onClose:()=>t(!1),children:[e.jsx(U,{children:e.jsx(A,{children:"Add Panel"})}),e.jsx(B,{children:e.jsxs(R,{children:[e.jsx(L,{className:"mt-3",children:"Select File"}),e.jsx(q,{type:"file",onChange:s=>j(s.target.files[0])})]})}),e.jsxs(H,{children:[e.jsx(n,{color:"secondary",size:"sm",onClick:()=>t(!1),children:"Close"}),e.jsx(n,{color:"primary",size:"sm",onClick:y,children:"Save changes"})]})]})]})};export{re as default};
