import{a as o,n as g,j as e}from"./index-CwQL2t-A.js";import"./DefaultLayout-DTx8TaoL.js";import{C as T}from"./index.esm-30w8qYLS.js";import{k as _,m as I}from"./api-tb7qjnUV.js";import{c as r}from"./toastUtils-B9v39y2b.js";import{C as P,a as w}from"./CRow-xZQvIvC4.js";import{C as S,a as k}from"./CCardBody-COp50SDu.js";import{C as M}from"./CCardHeader-m8c2HhZJ.js";import{a as n}from"./CContainer-imqrk4GV.js";import{C as v,a as z,b as f,c as i,d as D,e as d}from"./CTable-lk4-6KXX.js";import{c as E}from"./cil-trash-CBbKHhHb.js";import{C as N,a as U,b as A,c as B,d as H}from"./CModalTitle-DuUokrO8.js";import{C as R}from"./CForm-8mT-ZKp0.js";import{a as L,C as O}from"./CFormInput-rTe5DLkW.js";import"./hz_logo_5-CDgMsiCN.js";import"./cil-user-Ddrdy7PS.js";const oe=()=>{const[h,x]=o.useState([]),{id:a}=g(),[m,t]=o.useState(!1),[p,j]=o.useState(null),[C,F]=o.useState("");o.useEffect(()=>{console.log("URL parameter ID:",a),F(a),c(a)},[a]);const u=async s=>{const l=await I(s);console.log(l),c(a),r("File deleted successfully",1)},y=async()=>{if(!p||!C){r("Please select a file and provide panel ID",2);return}const s=new FormData;s.append("file",p),s.append("panel_id",C);try{const l=await fetch("http://13.203.228.41:8000/upload-file/",{method:"POST",body:s});if(l.ok)r("File uploaded successfully",1),t(!1);else{const b=await l.json();console.log("Upload failed: "+b.detail),r("Upload failed",2)}}catch(l){console.error("Error uploading file:",l),alert("Upload error"),r("Internal server error",2)}c(a)},c=async s=>{try{const l=await _(s);x(l),console.log(l)}catch{setError("Failed to load panels"),r("Internal server error",2)}};return e.jsxs(e.Fragment,{children:[e.jsx(P,{children:e.jsx(w,{xs:12,children:e.jsxs(S,{className:"mb-4",children:[e.jsxs(M,{children:[e.jsx("strong",{children:"Files"}),e.jsx(n,{color:"primary",size:"sm",className:"float-end",onClick:()=>t(!m),children:"Add Files"})]}),e.jsx(k,{children:e.jsxs(v,{children:[e.jsx(z,{children:e.jsxs(f,{children:[e.jsx(i,{scope:"col",children:"File Id"}),e.jsx(i,{scope:"col",children:"Panel Name"}),e.jsx(i,{scope:"col",children:"File Name"}),e.jsx(i,{scope:"col",children:"Actions"})]})}),e.jsx(D,{children:h.map((s,l)=>e.jsxs(f,{children:[e.jsx(i,{children:s.file_meta_id}),e.jsx(d,{children:s.panel_id}),e.jsx(d,{children:s.file_name}),e.jsx(d,{children:e.jsx(n,{size:"sm",onClick:()=>u(s.file_meta_id),children:e.jsx(T,{icon:E,size:"sm"})})})]},s.file_meta_id+" "+s.panel_id))})]})})]})})}),e.jsxs(N,{alignment:"center",visible:m,onClose:()=>t(!1),children:[e.jsx(U,{children:e.jsx(A,{children:"Add Panel"})}),e.jsx(B,{children:e.jsxs(R,{children:[e.jsx(L,{className:"mt-3",children:"Select File"}),e.jsx(O,{type:"file",onChange:s=>j(s.target.files[0])})]})}),e.jsxs(H,{children:[e.jsx(n,{color:"secondary",size:"sm",onClick:()=>t(!1),children:"Close"}),e.jsx(n,{color:"primary",size:"sm",onClick:y,children:"Save changes"})]})]})]})};export{oe as default};
