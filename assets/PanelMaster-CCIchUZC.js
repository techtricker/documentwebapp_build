import{a as s,_ as J,o as V,c as K,P as S,j as e,C as X}from"./index-C_n6VyLt.js";import{e as Y,c as d,i as Z,j as ee,k as ae}from"./api-ByAZStIw.js";import{C as se,a as le}from"./CRow-DRHUpItb.js";import{C as re,a as ne}from"./CCardBody-DIABjGfN.js";import{C as te}from"./CCardHeader-sVo3LTMB.js";import{C as oe,a as ie,b as T,c as F,d as de,e as h}from"./CTable-D0CHgu48.js";import{a as c}from"./CContainer-CjMlxGt7.js";import{C as B,a as L,b as D,c as H,d as A}from"./CModalTitle-DPtiesJb.js";import{C as ce}from"./CForm-DHzh99MZ.js";import{b as O,a as $,C as me}from"./CFormInput-C7FaTwva.js";import"./DefaultLayout-eGTvdpHD.js";import"./index.esm-42cyg-0j.js";import"./hz_logo_5-DSclOlyI.js";import"./cil-user-Ddrdy7PS.js";const Q=s.forwardRef((n,f)=>{var{children:w,className:j,feedback:b,feedbackInvalid:t,feedbackValid:o,floatingClassName:m,floatingLabel:u,id:g,invalid:r,label:x,plainText:C,text:p,tooltipFeedback:v,valid:i}=n,y=J(n,["children","className","feedback","feedbackInvalid","feedbackValid","floatingClassName","floatingLabel","id","invalid","label","plainText","text","tooltipFeedback","valid"]);return V.createElement(O,{describedby:y["aria-describedby"],feedback:b,feedbackInvalid:t,feedbackValid:o,floatingClassName:m,floatingLabel:u,id:g,invalid:r,label:x,text:p,tooltipFeedback:v,valid:i},V.createElement("textarea",Object.assign({className:K(C?"form-control-plaintext":"form-control",{"is-invalid":r,"is-valid":i},j),id:g},y,{ref:f}),w))});Q.propTypes=Object.assign({className:S.string,id:S.string,plainText:S.bool},O.propTypes);Q.displayName="CFormTextarea";const Se=()=>{const[n,f]=s.useState([]),[w,j]=s.useState(null),[b,t]=s.useState(!1),[o,m]=s.useState(""),[u,g]=s.useState(""),[r,x]=s.useState(""),[C,p]=s.useState(!1),[v,i]=s.useState(!1),[y,E]=s.useState(null),[z,_]=s.useState(null),[P,N]=s.useState(null),[I,M]=s.useState(!1);s.useEffect(()=>{p(!1),R()},[]);const R=async()=>{try{const a=await Y();f(a)}catch{j("Failed to load panels"),d("Internal Server Error",2)}},U=async()=>{try{C?(await ee({panel_name:o,description:r},u),d("Updated Successfully!",1)):(await ae({panel_name:o,description:r}),d("Created Successfully!",1)),m(""),x(""),t(!1),p(!1),R()}catch{d("Internal Server Error",2)}},W=async(a,k)=>{i(!0),E(a),N(null),M(!0),_(k);try{const l=await Z(a);N(l.qr_code_base64)}catch{d("Failed to load QR code",2)}finally{M(!1)}},q=()=>{i(!1),E(null),N(null),_(null)},G=(a,k)=>{const l=document.createElement("a");l.href=`data:image/png;base64,${a}`,l.download=`${k}-qr-code.png`,document.body.appendChild(l),l.click(),document.body.removeChild(l)};return e.jsxs(e.Fragment,{children:[e.jsx(se,{children:e.jsx(le,{xs:12,children:e.jsxs(re,{className:"mb-4",children:[e.jsx(te,{children:e.jsx("strong",{children:"All Panels"})}),e.jsx(ne,{children:e.jsxs(oe,{children:[e.jsx(ie,{children:e.jsxs(T,{children:[e.jsx(F,{children:"Panel Name"}),e.jsx(F,{children:"No. of Files"}),e.jsx(F,{children:"QR Code"})]})}),e.jsx(de,{children:n.length>0?n.map(a=>e.jsxs(T,{children:[e.jsx(h,{children:a.panel_name}),e.jsx(h,{children:a.file_count}),e.jsx(h,{children:e.jsx(c,{size:"sm",color:"info",onClick:()=>W(a.panel_id,a.panel_name),children:"View QR"})})]},a.panel_id)):e.jsx(T,{children:e.jsx(h,{colSpan:3,className:"text-center",children:"No record found"})})})]})})]})})}),e.jsxs(B,{alignment:"center",visible:b,onClose:()=>t(!1),children:[e.jsx(L,{children:e.jsx(D,{children:C?"Edit Panel":"Add Panel"})}),e.jsx(H,{children:e.jsxs(ce,{children:[e.jsxs("div",{className:"mb-3",children:[e.jsx($,{children:"Panel Name"}),e.jsx(me,{value:o,onChange:a=>m(a.target.value)})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx($,{children:"Description"}),e.jsx(Q,{rows:3,value:r,onChange:a=>x(a.target.value)})]})]})}),e.jsxs(A,{children:[e.jsx(c,{color:"secondary",onClick:()=>t(!1),children:"Close"}),e.jsx(c,{color:"primary",onClick:U,children:"Save"})]})]}),e.jsxs(B,{alignment:"center",visible:v,onClose:q,children:[e.jsx(L,{children:e.jsx(D,{children:"Panel QR Code"})}),e.jsxs(H,{className:"text-center",children:[I&&e.jsx(X,{}),!I&&P&&e.jsxs(e.Fragment,{children:[e.jsx("img",{src:`data:image/png;base64,${P}`,alt:"Panel QR",style:{width:250}}),e.jsx("div",{className:"mt-3",children:e.jsx(c,{color:"primary",onClick:()=>G(P,z),children:"Download QR"})})]})]}),e.jsx(A,{children:e.jsx(c,{color:"secondary",onClick:q,children:"Close"})})]})]})};export{Se as default};
