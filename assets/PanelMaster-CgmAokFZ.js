import{a as s,_ as W,o as V,c as G,P as S,j as e,C as J}from"./index-D6Jq3K-x.js";import{e as K,c as d,i as X,j as Y,k as Z}from"./api-DNt6p5pr.js";import{C as ee,a as ae}from"./CRow-B_wr-fKM.js";import{C as se,a as le}from"./CCardBody-BJc_-Mbn.js";import{C as re}from"./CCardHeader-CQ5ah_nf.js";import{C as te,a as ne,b as T,c as F,d as ie,e as j}from"./CTable-DxwI5Xhb.js";import{a as c}from"./CContainer-Dfo9oL2s.js";import{C as q,a as B,b as L,c as D,d as H}from"./CModalTitle-DNXVKnjk.js";import{C as oe}from"./CForm-B3UjcyYF.js";import{b as $,a as A,C as de}from"./CFormInput-B69Gv90_.js";import"./DefaultLayout-DMR4_zOt.js";import"./index.esm-CbLieEqJ.js";import"./hz_logo_5-DkmOu-nl.js";import"./cil-user-Ddrdy7PS.js";const Q=s.forwardRef((r,b)=>{var{children:w,className:u,feedback:g,feedbackInvalid:t,feedbackValid:n,floatingClassName:m,floatingLabel:v,id:y,invalid:l,label:x,plainText:C,text:p,tooltipFeedback:P,valid:i}=r,h=W(r,["children","className","feedback","feedbackInvalid","feedbackValid","floatingClassName","floatingLabel","id","invalid","label","plainText","text","tooltipFeedback","valid"]);return V.createElement($,{describedby:h["aria-describedby"],feedback:g,feedbackInvalid:t,feedbackValid:n,floatingClassName:m,floatingLabel:v,id:y,invalid:l,label:x,text:p,tooltipFeedback:P,valid:i},V.createElement("textarea",Object.assign({className:G(C?"form-control-plaintext":"form-control",{"is-invalid":l,"is-valid":i},u),id:y},h,{ref:b}),w))});Q.propTypes=Object.assign({className:S.string,id:S.string,plainText:S.bool},$.propTypes);Q.displayName="CFormTextarea";const Ne=()=>{const[r,b]=s.useState([]),[w,u]=s.useState(null),[g,t]=s.useState(!1),[n,m]=s.useState(""),[v,y]=s.useState(""),[l,x]=s.useState(""),[C,p]=s.useState(!1),[P,i]=s.useState(!1),[h,E]=s.useState(null),[N,k]=s.useState(null),[I,M]=s.useState(!1);s.useEffect(()=>{p(!1),R()},[]);const R=async()=>{try{const a=await K();b(a)}catch{u("Failed to load panels"),d("Internal Server Error",2)}},O=async()=>{try{C?(await Y({panel_name:n,description:l},v),d("Updated Successfully!",1)):(await Z({panel_name:n,description:l}),d("Created Successfully!",1)),m(""),x(""),t(!1),p(!1),R()}catch{d("Internal Server Error",2)}},z=async a=>{i(!0),E(a),k(null),M(!0);try{const f=await X(a);k(f.qr_code_base64)}catch{d("Failed to load QR code",2)}finally{M(!1)}},_=()=>{i(!1),E(null),k(null)},U=(a,f)=>{const o=document.createElement("a");o.href=`data:image/png;base64,${a}`,o.download=`panel-${f}-qr.png`,document.body.appendChild(o),o.click(),document.body.removeChild(o)};return e.jsxs(e.Fragment,{children:[e.jsx(ee,{children:e.jsx(ae,{xs:12,children:e.jsxs(se,{className:"mb-4",children:[e.jsx(re,{children:e.jsx("strong",{children:"All Panels"})}),e.jsx(le,{children:e.jsxs(te,{children:[e.jsx(ne,{children:e.jsxs(T,{children:[e.jsx(F,{children:"Panel Name"}),e.jsx(F,{children:"No. of Files"}),e.jsx(F,{children:"QR Code"})]})}),e.jsx(ie,{children:r.length>0?r.map(a=>e.jsxs(T,{children:[e.jsx(j,{children:a.panel_name}),e.jsx(j,{children:a.file_count}),e.jsx(j,{children:e.jsx(c,{size:"sm",color:"info",onClick:()=>z(a.panel_id),children:"View QR"})})]},a.panel_id)):e.jsx(T,{children:e.jsx(j,{colSpan:3,className:"text-center",children:"No record found"})})})]})})]})})}),e.jsxs(q,{alignment:"center",visible:g,onClose:()=>t(!1),children:[e.jsx(B,{children:e.jsx(L,{children:C?"Edit Panel":"Add Panel"})}),e.jsx(D,{children:e.jsxs(oe,{children:[e.jsxs("div",{className:"mb-3",children:[e.jsx(A,{children:"Panel Name"}),e.jsx(de,{value:n,onChange:a=>m(a.target.value)})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx(A,{children:"Description"}),e.jsx(Q,{rows:3,value:l,onChange:a=>x(a.target.value)})]})]})}),e.jsxs(H,{children:[e.jsx(c,{color:"secondary",onClick:()=>t(!1),children:"Close"}),e.jsx(c,{color:"primary",onClick:O,children:"Save"})]})]}),e.jsxs(q,{alignment:"center",visible:P,onClose:_,children:[e.jsx(B,{children:e.jsx(L,{children:"Panel QR Code"})}),e.jsxs(D,{className:"text-center",children:[I&&e.jsx(J,{}),!I&&N&&e.jsxs(e.Fragment,{children:[e.jsx("img",{src:`data:image/png;base64,${N}`,alt:"Panel QR",style:{width:250}}),e.jsx("div",{className:"mt-3",children:e.jsx(c,{color:"primary",onClick:()=>U(N,h),children:"Download QR"})})]})]}),e.jsx(H,{children:e.jsx(c,{color:"secondary",onClick:_,children:"Close"})})]})]})};export{Ne as default};
